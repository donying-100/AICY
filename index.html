
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>åœ¨çº¿ç®€å†ä¿®æ”¹å™¨</title>
  <!-- å¼•å…¥docx4jsåº“ç”¨äºç”ŸæˆWordæ–‡æ¡£ -->
  <script src="https://cdn.jsdelivr.net/npm/docx4js@1.3.0/dist/docx4js.min.js"></script>
  <!-- å¼•å…¥html2pdf.jsåº“ç”¨äºç”ŸæˆPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
  <style>
    body {
      font-family: "Segoe UI", "Helvetica Neue", sans-serif;
      background: linear-gradient(135deg, #f0f4ff, #e0ecff);
      margin: 0;
      padding: 0;
      color: #333;
    }

    /* é¡µé¢æ ‡é¢˜æ ·å¼ */
    .page-title {
      text-align: center;
      padding: 40px 0 30px 0;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(240, 244, 255, 0.9));
      backdrop-filter: blur(20px);
      margin-bottom: 30px;
      border-bottom: 1px solid rgba(63, 81, 181, 0.1);
      position: relative;
      overflow: hidden;
    }

    .page-title::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
      animation: shimmer 3s infinite;
    }

    @keyframes shimmer {
      0% { left: -100%; }
      100% { left: 100%; }
    }

    .page-title h1 {
      font-size: 36px;
      font-weight: 800;
      margin: 0 0 12px 0;
      text-shadow: 0 4px 8px rgba(63, 81, 181, 0.2);
      letter-spacing: 1px;
      position: relative;
      z-index: 1;
    }

    .page-title h1 .icon {
      font-size: 36px;
      display: inline-block;
      vertical-align: middle;
    }

    .page-title h1 .title-text {
      background: linear-gradient(135deg, #3f51b5, #5c6bc0, #7986cb);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      display: inline-block;
      vertical-align: middle;
    }

    .page-title p {
      font-size: 18px;
      color: #666;
      margin: 0;
      font-weight: 500;
      opacity: 0.9;
      position: relative;
      z-index: 1;
    }




    .container {
      max-width: 680px;
      margin: 0 auto 50px auto;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      padding: 50px 60px;
    }

    .header {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      margin-bottom: 30px;
    }

    .avatar {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      overflow: hidden;
      border: 4px solid #3f51b5;
      position: relative;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .avatar:hover {
      border-color: #5c6bc0;
      transform: scale(1.05);
    }

    .avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .avatar-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.3s ease;
      color: white;
      font-size: 12px;
      text-align: center;
    }

    .avatar:hover .avatar-overlay {
      opacity: 1;
    }

    #avatar-input {
      display: none;
    }

    /* å¯¼å‡ºPDFæŒ‰é’®æ ·å¼ */
    .export-section {
      text-align: center;
      margin: 30px auto 50px auto;
      max-width: 680px;
    }

    .export-btn {
      background: linear-gradient(135deg, #3f51b5, #5c6bc0);
      color: white;
      border: none;
      padding: 12px 30px;
      border-radius: 25px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(63, 81, 181, 0.3);
      min-width: 150px;
      margin: 0 10px; /* æ·»åŠ æŒ‰é’®é—´è· */
    }

    .export-btn:hover {
      background: linear-gradient(135deg, #5c6bc0, #7986cb);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(63, 81, 181, 0.4);
    }

    .export-btn:active {
      transform: translateY(0);
      box-shadow: 0 2px 10px rgba(63, 81, 181, 0.3);
    }

    .export-btn:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    /* ä½œè€…ä¿¡æ¯æ ·å¼ */
    .author-info {
      text-align: center;
      margin: 20px auto 30px auto;
      max-width: 680px;
      padding: 15px 0;
      border-top: 1px solid #e0ecff;
    }

    .author-info p {
      margin: 0;
      font-size: 14px;
      color: #888;
      font-weight: 400;
    }

    /* PDFå¯¼å‡ºæ—¶éšè—ç½‘é¡µç•Œé¢å…ƒç´  */
    @media print {
      .export-section,
      .page-title,
      .add-btn,
      .author-info {
        display: none !important;
      }
    }

    /* å³é”®èœå•æ ·å¼ */
    .context-menu {
      position: fixed;
      background: white;
      border: 1px solid #ddd;
      border-radius: 6px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      padding: 4px 0;
      z-index: 1000;
      min-width: 100px;
      display: none;
    }

    .context-menu-item {
      padding: 8px 16px;
      cursor: pointer;
      font-size: 14px;
      color: #333;
      transition: background-color 0.2s;
    }

    .context-menu-item:hover {
      background-color: #f5f5f5;
    }

    .context-menu-item.delete {
      color: #f44336;
    }

    .context-menu-item.delete:hover {
      background-color: #ffebee;
    }



    .title {
      flex: 1;
      margin-left: 30px;
    }

    .title h1, .title p {
      margin: 0;
    }

    .title h1 {
      font-size: 28px;
      color: #3f51b5;
    }

    .title p {
      margin-top: 8px;
      font-size: 16px;
      color: #666;
    }

    h2 {
      color: #303f9f;
      font-size: 20px;
      font-weight: 600;
      margin-top: 40px;
      margin-bottom: 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .info {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      font-size: 15px;
      margin-bottom: 30px;
      color: #555;
    }

    .info div {
      margin: 6px 0;
    }

    p, li {
      line-height: 1.6;
      cursor: pointer;
    }



    ul {
      padding-left: 20px;
    }

    .editable{
      margin: 0;
    }

    /* å„æ¨¡å—itemé—´è· */
    #project-list .project-item,
    #work-list .work-item,
    #education-list .education-item {
      margin-bottom: 15px;
    }

    #project-list .project-item:last-child,
    #work-list .work-item:last-child,
    #education-list .education-item:last-child {
      margin-bottom: 0;
    }

    .editable:focus {
      outline: 2px dashed #3f51b5;
      background: #eef2ff;
    }

    button.add-btn {
      font-size: 14px;
      background: #3f51b5;
      color: white;
      border: none;
      padding: 4px 10px;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s;
      flex-shrink: 0;
    }

    button.add-btn:hover {
      background: #5c6bc0;
    }

    @media (max-width: 600px) {
      .page-title {
        padding: 30px 20px 25px 20px;
      }

      .page-title h1 {
        font-size: 28px;
        letter-spacing: 0.5px;
      }

      .page-title p {
        font-size: 16px;
        padding: 0 10px;
      }



      .container {
        padding: 30px 20px;
      }

      .header {
        flex-direction: column;
        align-items: center;
      }

      .title {
        margin-left: 0;
        text-align: center;
        margin-top: 10px;
      }

      .info {
        flex-direction: column;
      }

      /* åœ¨å°å±å¹•ä¸Šè°ƒæ•´å¯¼å‡ºæŒ‰é’®æ ·å¼ */
      .export-section {
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .export-btn {
        margin: 10px 0;
        width: 80%;
      }
    }
  </style>
</head>
<body>
  <!-- é¡µé¢æ ‡é¢˜ -->
  <div class="page-title">
    <h1><span class="icon">ğŸ“‹</span> <span class="title-text">åœ¨çº¿ç®€å†</span></h1>
    <p> é¡µé¢ç¾è§‚ â€¢ æ“ä½œç®€å• â€¢ æ°¸ä¹…å…è´¹ </p>
  </div>

  <div class="container">
    <div class="header">
      <div class="avatar" onclick="changeAvatar()">
        <img id="avatar-img" src="https://images.unsplash.com/photo-1603415526960-f7e0328c63b1?crop=faces&fit=crop&w=200&h=200" alt="å¤´åƒ">
        <div class="avatar-overlay">
          ç‚¹å‡»æ›´æ¢<br>å¤´åƒ
        </div>
      </div>
      <input type="file" id="avatar-input" accept="image/*" onchange="handleAvatarChange(event)">
      <div class="title">
        <h1 class="editable" contenteditable="true">é›·å°å†›</h1>
        <p class="editable" contenteditable="true">å‰ç«¯å·¥ç¨‹å¸ˆ | Vue / React / TypeScript / Node.js</p>
      </div>
    </div>

    <div class="info">
      <div class="editable" contenteditable="true">ğŸ§ ç”· | 38å²</div>
      <div class="editable" contenteditable="true">ğŸ“ åŒ—äº¬ | 20å¹´ç»éªŒ</div>
      <div class="editable" contenteditable="true">ğŸ“ 13500001234</div>
      <div class="editable" contenteditable="true">ğŸ“ æœ¬ç§‘å­¦å†</div>
    </div>

    <h2>
      <span>æ•™è‚²èƒŒæ™¯</span>
      <button class="add-btn" onclick="addEducation()"> æ·»åŠ </button>
    </h2>
    <div id="education-list">
      <div class="education-item">
        <p class="editable" contenteditable="true">
          <strong>ä¸Šæµ·äº¤é€šå¤§å­¦</strong>ï½œè®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯ æœ¬ç§‘ï½œ2014 - 2018
        </p>
      </div>
    </div>

    <h2>
      <span>å·¥ä½œç»å†</span>
      <button class="add-btn" onclick="addWork()"> æ·»åŠ </button>
    </h2>
    <div id="work-list">
      <div class="work-item">
        <p class="editable" contenteditable="true">
          <strong>å­—èŠ‚è·³åŠ¨ | é«˜çº§å‰ç«¯å·¥ç¨‹å¸ˆ</strong> <span style="float:right;">2021.04 - è‡³ä»Š</span><br>
          è´Ÿè´£ç›´æ’­å¹³å°è¿è¥åå°å¼€å‘ï¼Œä¼˜åŒ–ç»„ä»¶æ€§èƒ½ã€å¼•å…¥è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œæå‡å‰ç«¯è´¨é‡ã€‚
        </p>
      </div>
      <div class="work-item">
        <p class="editable" contenteditable="true">
          <strong>ç½‘æ˜“äº‘éŸ³ä¹ | å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ</strong> <span style="float:right;">2018.07 - 2021.03</span><br>
          å‚ä¸å¤šä¸ªæ ¸å¿ƒé¡µé¢é‡æ„åŠç»„ä»¶æŠ½è±¡ï¼Œæ¨åŠ¨è·¨éƒ¨é—¨å‰ç«¯è§„èŒƒå»ºè®¾ã€‚
        </p>
      </div>
    </div>

    <h2>
      <span>é¡¹ç›®ç»éªŒ</span>
      <button class="add-btn" onclick="addProject()"> æ·»åŠ </button>
    </h2>
    <ul id="project-list">
      <li class="project-item">
        <div class="editable" contenteditable="true">
          <strong>æ™ºèƒ½å†…å®¹ç®¡ç†å¹³å°</strong>ï¼ˆVue3 + Element Plusï¼‰<br>
          æ”¯æŒå¤šè§’è‰²æƒé™ç®¡ç†ã€å¯è§†åŒ–å†…å®¹ç¼–è¾‘å™¨ï¼Œå®ç°åŠ¨æ€ç»„ä»¶æ¸²æŸ“ä¸æ•°æ®ç»‘å®šï¼ŒæœåŠ¡ä¸Šç™¾ä¸‡ç”¨æˆ·ã€‚
        </div>
      </li>
      <li class="project-item">
        <div class="editable" contenteditable="true">
          <strong>è·¨å¢ƒç”µå•†å®˜ç½‘</strong>ï¼ˆReact + Next.jsï¼‰<br>
          å®ç°é™æ€ç”Ÿæˆä¸æœåŠ¡ç«¯æ¸²æŸ“ç»“åˆï¼Œä¼˜åŒ– SEO ä¸é¦–å±æ€§èƒ½ï¼Œç§»åŠ¨ç«¯é€‚é…æµç•…ã€‚
        </div>
      </li>
      <li class="project-item">
        <div class="editable" contenteditable="true">
          <strong>H5 æ´»åŠ¨é¡µç»„ä»¶å¹³å°</strong>ï¼ˆVite + Vueï¼‰<br>
          æ‹–æ‹½å¼é…ç½®ç³»ç»Ÿ + å¯å¤ç”¨ç»„ä»¶åº“ï¼Œæ”¯æŒå¤šç§ä¸»é¢˜æ¨¡æ¿ä¸å¯¼å‡ºï¼ŒèŠ‚çœ 80% é¡µé¢å¼€å‘æ—¶é—´ã€‚
        </div>
      </li>
    </ul>

    <h2>ä¸ªäººç®€ä»‹</h2>
    <p class="editable" contenteditable="true">
      å…·å¤‡ä¸°å¯Œçš„å‰ç«¯å¼€å‘ç»éªŒï¼Œç²¾é€š Vue / React ç­‰ä¸»æµæ¡†æ¶ï¼Œæ“…é•¿æ„å»ºé«˜æ€§èƒ½ç»„ä»¶å’Œä¼˜é›… UIï¼Œå‚ä¸å¤šä¸ªå¤§å‹é¡¹ç›®å¼€å‘ã€‚å…³æ³¨ç”¨æˆ·ä½“éªŒï¼Œçƒ­çˆ±æ¢ç´¢æ–°æŠ€æœ¯ï¼Œå…·å¤‡è‰¯å¥½çš„å›¢é˜Ÿæ²Ÿé€šä¸åä½œèƒ½åŠ›ã€‚
    </p>
  </div>

  <!-- å¯¼å‡ºæŒ‰é’® -->
  <div class="export-section">
    <button class="export-btn" onclick="exportToPDF()">ğŸ“„ å¯¼å‡ºPDF</button>
    <button class="export-btn" onclick="exportToWODE()">ğŸ“ å¯¼å‡ºWODE</button>
    <button class="export-btn" onclick="clearSettings()">ğŸ—‘ï¸ æ¸…é™¤è®¾ç½®</button>
  </div>

  <!-- ä½œè€…ä¿¡æ¯ -->
  <div class="author-info">
    <p>Â© 2025 å…è´¹ç®€å†</p>
  </div>

  <!-- å³é”®èœå• -->
  <div id="context-menu" class="context-menu">
    <div class="context-menu-item delete" onclick="deleteCurrentItem()">åˆ é™¤</div>
  </div>

  <script>
    // æ”¯æŒæŒ‰å›è½¦é€€å‡ºç¼–è¾‘çŠ¶æ€
    document.querySelectorAll('.editable').forEach(el => {
      el.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          el.blur();
        }
      });
    });

    // æ›´æ¢å¤´åƒåŠŸèƒ½
    function changeAvatar() {
      document.getElementById('avatar-input').click();
    }

    function handleAvatarChange(event) {
      const file = event.target.files[0];
      if (file) {
        // æ£€æŸ¥æ–‡ä»¶ç±»å‹
        if (!file.type.startsWith('image/')) {
          alert('è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶ï¼');
          return;
        }

        // æ£€æŸ¥æ–‡ä»¶å¤§å°ï¼ˆé™åˆ¶ä¸º5MBï¼‰
        if (file.size > 5 * 1024 * 1024) {
          alert('å›¾ç‰‡æ–‡ä»¶ä¸èƒ½è¶…è¿‡5MBï¼');
          return;
        }

        const reader = new FileReader();
        reader.onload = function(e) {
          document.getElementById('avatar-img').src = e.target.result;
        };
        reader.readAsDataURL(file);
      }
    }

    // å³é”®èœå•ç›¸å…³å˜é‡
    let currentItem = null;
    const contextMenu = document.getElementById('context-menu');

    // ä¸ºé¡¹ç›®ç»‘å®šå³é”®èœå•äº‹ä»¶ï¼ˆé€šç”¨å‡½æ•°ï¼‰
    function bindContextMenu(item) {
      item.addEventListener('contextmenu', function(e) {
        e.preventDefault();
        currentItem = item;

        // æ˜¾ç¤ºå³é”®èœå•ï¼Œä½¿ç”¨clientX/clientYè·å–ç›¸å¯¹äºè§†çª—çš„åæ ‡
        contextMenu.style.display = 'block';
        contextMenu.style.left = e.clientX + 'px';
        contextMenu.style.top = e.clientY + 'px';
      });
    }

    // åˆ é™¤å½“å‰é¡¹ç›®ï¼ˆé€šç”¨åˆ é™¤å‡½æ•°ï¼‰
    function deleteCurrentItem() {
      if (!currentItem) return;

      let confirmMessage = 'ç¡®å®šè¦åˆ é™¤è¿™ä¸ªé¡¹ç›®å—ï¼Ÿ';
      if (currentItem.classList.contains('work-item')) {
        confirmMessage = 'ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå·¥ä½œç»å†å—ï¼Ÿ';
      } else if (currentItem.classList.contains('education-item')) {
        confirmMessage = 'ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ•™è‚²èƒŒæ™¯å—ï¼Ÿ';
      } else if (currentItem.classList.contains('project-item')) {
        confirmMessage = 'ç¡®å®šè¦åˆ é™¤è¿™ä¸ªé¡¹ç›®ç»éªŒå—ï¼Ÿ';
      }

      if (confirm(confirmMessage)) {
        currentItem.remove();
        hideContextMenu();
      }
    }

    // éšè—å³é”®èœå•
    function hideContextMenu() {
      contextMenu.style.display = 'none';
      currentItem = null;
    }

    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', function() {
      // ä¸ºç°æœ‰çš„æ‰€æœ‰é¡¹ç›®ç»‘å®šå³é”®èœå•
      document.querySelectorAll('.work-item, .education-item, .project-item').forEach(bindContextMenu);

      // ç‚¹å‡»å…¶ä»–åœ°æ–¹éšè—å³é”®èœå•
      document.addEventListener('click', hideContextMenu);

      // é˜»æ­¢å³é”®èœå•çš„ç‚¹å‡»äº‹ä»¶å†’æ³¡
      contextMenu.addEventListener('click', function(e) {
        e.stopPropagation();
      });
    });

    // æ·»åŠ é¡¹ç›®ç»éªŒ
    function addProject() {
      const ul = document.getElementById('project-list');
      const li = document.createElement('li');
      li.className = 'project-item';

      const contentDiv = document.createElement('div');
      contentDiv.className = 'editable';
      contentDiv.contentEditable = true;
      contentDiv.innerHTML = '<strong>é¡¹ç›®åç§°</strong>ï¼ˆæŠ€æœ¯æ ˆï¼‰<br>é¡¹ç›®æè¿°...';

      li.appendChild(contentDiv);
      ul.appendChild(li);
      contentDiv.focus();

      contentDiv.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          contentDiv.blur();
        }
      });

      // ä¸ºæ–°æ·»åŠ çš„é¡¹ç›®ç»‘å®šå³é”®èœå•äº‹ä»¶
      bindContextMenu(li);
    }

    // æ·»åŠ å·¥ä½œç»å†
    function addWork() {
      const div = document.getElementById('work-list');
      const workItem = document.createElement('div');
      workItem.className = 'work-item';

      const p = document.createElement('p');
      p.className = 'editable';
      p.contentEditable = true;
      p.innerHTML = '<strong>å…¬å¸åç§° | èŒä½</strong> <span style="float:right;">å¼€å§‹æ—¶é—´ - ç»“æŸæ—¶é—´</span><br>å·¥ä½œæè¿°...';

      workItem.appendChild(p);
      div.appendChild(workItem);
      p.focus();

      p.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          p.blur();
        }
      });

      // ä¸ºæ–°æ·»åŠ çš„å·¥ä½œé¡¹ç›®ç»‘å®šå³é”®èœå•äº‹ä»¶
      bindContextMenu(workItem);
    }

    // æ·»åŠ æ•™è‚²èƒŒæ™¯
    function addEducation() {
      const div = document.getElementById('education-list');
      const educationItem = document.createElement('div');
      educationItem.className = 'education-item';

      const p = document.createElement('p');
      p.className = 'editable';
      p.contentEditable = true;
      p.innerHTML = '<strong>å­¦æ ¡åç§°</strong>ï½œä¸“ä¸š å­¦å†ï½œå¼€å§‹å¹´ä»½ - ç»“æŸå¹´ä»½';

      educationItem.appendChild(p);
      div.appendChild(educationItem);
      p.focus();

      p.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          p.blur();
        }
      });

      // ä¸ºæ–°æ·»åŠ çš„æ•™è‚²èƒŒæ™¯ç»‘å®šå³é”®èœå•äº‹ä»¶
      bindContextMenu(educationItem);
    }

    // PDFå¯¼å‡ºåŠŸèƒ½
    async function exportToPDF() {
      try {
        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        const exportBtn = event.target;
        const originalText = exportBtn.textContent;
        exportBtn.textContent = 'å¯¼å‡ºä¸­...';
        exportBtn.disabled = true;

        // è·å–ç®€å†å†…å®¹
        const container = document.querySelector('.container');
        
        // ä½¿ç”¨html2pdf.jsç”ŸæˆPDF
        const options = {
          margin: 10,
          filename: 'ç®€å†.pdf',
          image: { type: 'jpeg', quality: 0.98 },
          html2canvas: { scale: 2, useCORS: true },
          jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
        };

        await html2pdf().set(options).from(container).save();
        
        console.log('PDFå¯¼å‡ºæˆåŠŸ');
      } catch (error) {
        console.error('PDFå¯¼å‡ºå¤±è´¥:', error);
        alert('PDFå¯¼å‡ºå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
      } finally {
        // æ¢å¤æŒ‰é’®çŠ¶æ€
        const exportBtn = document.querySelector('.export-btn');
        if (exportBtn) {
          exportBtn.textContent = 'ğŸ“„ å¯¼å‡ºPDF';
          exportBtn.disabled = false;
        }
      }
    }

    // æ¸…é™¤è®¾ç½®åŠŸèƒ½
    function clearSettings() {
      if (confirm('ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰è®¾ç½®å¹¶æ¢å¤åˆ°åˆå§‹çŠ¶æ€å—ï¼Ÿ')) {
        // é‡æ–°åŠ è½½é¡µé¢ä»¥æ¢å¤åˆå§‹çŠ¶æ€
        location.reload();
      }
    }

    // å¯¼å‡ºWODEåŠŸèƒ½
    async function exportToWODE() {
      try {
        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        const exportBtns = document.querySelectorAll('.export-btn');
        exportBtns.forEach(btn => {
          btn.textContent = 'å¯¼å‡ºä¸­...';
          btn.disabled = true;
        });

        // è·å–ç®€å†å†…å®¹
        const name = document.querySelector('.title h1').textContent || 'ç®€å†';
        const title = document.querySelector('.title p').textContent || '';
        const infoItems = Array.from(document.querySelectorAll('.info .editable')).map(el => el.textContent);
        const educationItems = Array.from(document.querySelectorAll('#education-list .education-item .editable')).map(el => el.textContent);
        const workItems = Array.from(document.querySelectorAll('#work-list .work-item .editable')).map(el => el.textContent);
        const projectItems = Array.from(document.querySelectorAll('#project-list .project-item .editable')).map(el => el.textContent);
        const profile = document.querySelector('.container > p:last-child').textContent || '';

        // ä½¿ç”¨docxåº“åˆ›å»ºWordæ–‡æ¡£
        const { Document } = window.docx;
        const { Paragraph } = window.docx;
        const { TextRun } = window.docx;
        const { HeadingLevel } = window.docx;
        const { AlignmentType } = window.docx;

        const doc = new Document({
          sections: [{
            properties: {},
            children: [
              new Paragraph({
                text: name,
                heading: HeadingLevel.HEADING_1,
                alignment: AlignmentType.CENTER,
              }),
              new Paragraph({
                text: title,
                alignment: AlignmentType.CENTER,
              }),
              new Paragraph({}),
              ...infoItems.map(item => new Paragraph({
                text: item,
              })),
              new Paragraph({}),
              new Paragraph({
                text: "æ•™è‚²èƒŒæ™¯",
                heading: HeadingLevel.HEADING_2,
              }),
              ...educationItems.map(item => new Paragraph({
                text: item,
                indent: { left: 720 }, // 720 TWIP = 0.5 inch
              })),
              new Paragraph({}),
              new Paragraph({
                text: "å·¥ä½œç»å†",
                heading: HeadingLevel.HEADING_2,
              }),
              ...workItems.map(item => new Paragraph({
                text: item,
                indent: { left: 720 },
              })),
              new Paragraph({}),
              new Paragraph({
                text: "é¡¹ç›®ç»éªŒ",
                heading: HeadingLevel.HEADING_2,
              }),
              ...projectItems.map(item => new Paragraph({
                text: item,
                indent: { left: 720 },
              })),
              new Paragraph({}),
              new Paragraph({
                text: "ä¸ªäººç®€ä»‹",
                heading: HeadingLevel.HEADING_2,
              }),
              new Paragraph({
                text: profile,
                indent: { left: 720 },
              }),
            ],
          }],
        });

        // ç”Ÿæˆæ–‡æ¡£å¹¶ä¸‹è½½
        const { Packer } = window.docx;
        const blob = await Packer.toBlob(doc);
        
        // åˆ›å»ºä¸‹è½½é“¾æ¥
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.style.display = 'none';
        a.href = url;
        a.download = 'ç®€å†.docx';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);

        console.log('WODEå¯¼å‡ºæˆåŠŸ');
      } catch (error) {
        console.error('WODEå¯¼å‡ºå¤±è´¥:', error);
        alert('WODEå¯¼å‡ºå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
      } finally {
        // æ¢å¤æŒ‰é’®çŠ¶æ€
        const exportBtns = document.querySelectorAll('.export-btn');
        exportBtns.forEach(btn => {
          if (btn.textContent === 'å¯¼å‡ºä¸­...') {
            if (btn.onclick && btn.onclick.toString().includes('exportToPDF')) {
              btn.textContent = 'ğŸ“„ å¯¼å‡ºPDF';
            } else if (btn.onclick && btn.onclick.toString().includes('exportToWODE')) {
              btn.textContent = 'ğŸ“ å¯¼å‡ºWODE';
            } else {
              btn.textContent = 'ğŸ—‘ï¸ æ¸…é™¤è®¾ç½®';
            }
            btn.disabled = false;
          }
        });
      }
    }
  </script>
</body>
</html>
